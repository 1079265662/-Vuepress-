---
title: 一些杂项知识点
date: 2023-02-23
cover: https://jinyanlong-1305883696.cos.ap-hongkong.myqcloud.com/202302231809603.jpg
tags:
 - other
categories: other
---

::: tip 介绍
整合并记录一些不常用但有价值的知识点 <br>
:::

<!-- more -->

## JSON的特性

JSONS会把方法`()=>`(箭头函数)和`undefined`, 的key或value值删除掉, 但是`null`值不会删除

![image-20230223164501413](https://jinyanlong-1305883696.cos.ap-hongkong.myqcloud.com/202302231646160.png)

利用这个特性, 可以实现一个给后端按需传参的操作, 比如后端有个条件, 满足条件的时候传入相应的`key: value`参数, 那我们就可以通过给value或者key赋值为`undefined`来实现这个需求

```js
const { code, message } = await saveUserWithCustId({
    // 通过三元表达式进行判断如果type为1 那么设置key名, 否则就是undefined, 不提交这个key
  [type === 1 ? 'btime' : undefined]:
    '提交的数据',
})

```

或者也可以通过给value设置undefined来实现

```js
const { code, message } = await saveUserWithCustId({
  btime: type === 1  ? '提交的数据' : undefined,
})

```

::: tip 其他拓展

在[GET](https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Methods/GET) 请求中, 如果value是`null`, 那么在请求的时候也会不携带该条参数, 但是[POST](https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Methods/POST) 会携带, `POST`支持value为`null`的提交

:::

## npm版本号定义

版本格式：`X.Y.Z[-string]`
 其含义为：

- X：主版本号
- Y：次版本号
- Z：修正版本号
- string: 先行版本号或版本编译信息

举个例子：

`6.3.2-alpha`的含义为：

主版本号6，有6次不可向下兼容的更新迭代。
 次版本号3，有3次小的功能迭代。`6.*.*` <=`6.3.2`的依赖声明，都可以安装此新包。
 修正版本号2，有2次bug修改或其他非重大功能的修改。`6.*.*` <=`6.3.2`的依赖声明，都可以安装此新包。
 先行版本号`alpha`，表示处理试验阶段。

扩展阅读：[语义化版本 2.0.0](https://semver.org/lang/zh-CN/#%E8%AF%AD%E4%B9%89%E5%8C%96%E7%89%88%E6%9C%AC-200)

## package.json怎么识别依赖版本

假设有这些依赖内容：

```json
"vue": "~2.5.22",
"vue-class-component": "^6.0.0",
"vue-router": "3.0.1",
"express": "latest",
"mongoose": "*"

```

**符号`^`：锁定主版本，可更新次版本号、修正版本号和先行版本号**, **只会执行不更改最左边非零数字的更新。** 

- 如果写入的是 `^0.13.0`，则当运行 `npm update` 时，可以更新到 `0.13.1`、`0.13.2` 等，但不能更新到 `0.14.0` 或更高版本。 
- 如果写入的是 `^1.13.0`，则当运行 `npm update` 时，可以更新到 `1.13.1`、`1.14.0` 等，但不能更新到 `2.0.0` 或更高版本。

**符号`~`：锁定主版本号和次版本号，可更新修正版本号和先行版本**

- 如果写入的是 `〜0.13.0`，则当运行 `npm update` 时，会更新到补丁版本：即 `0.13.1` 可以，但 `0.14.0` 不可以。

**没有`符号`：锁定所有版本号**

- 例如`"vue-router": "3.0.1"`，只能安装版本为`3.0.1`的依赖包。

**符号`\*`：定义某个版本号范围**

- 例如`vue-router": "3.0.*"`，可以安装`3.0`固定的任意版本，比如`3.0.1`、`3.0.2`。

**`只有*`：安装最新发布的版本，不一定是稳定版本**

* 例如`"mongoose": "*"`,可以安装`6.0.0-rc2`、`3.9.7`等。

![image-20230310163215993](https://jinyanlong-1305883696.cos.ap-hongkong.myqcloud.com/202303101632741.png)

**`latest`：安装最新的稳定版本**

* 例如`"express": "latest"`，可以安装`4.18.1` (2022.06.13最新版本)。

![image-20230310163151705](https://jinyanlong-1305883696.cos.ap-hongkong.myqcloud.com/202303101632731.png)

`>`: 接受高于指定版本的任何版本。

`>=`: 接受等于或高于指定版本的任何版本。

`<=`: 接受等于或低于指定版本的任何版本。

`<`: 接受低于指定版本的任何版本。

`=`: 接受确切的版本。

`-`: 接受一定范围的版本。例如：`2.1.0 - 2.6.2`。

`||`: 组合集合。例如 `< 2.1 || > 2.6`。

可以合并其中的一些符号，例如 `1.0.0 || >=1.1.0 <1.2.0`，即使用 1.0.0 或从 1.1.0 开始但低于 1.2.0 的版本。

扩展阅读：[npm docs - dependencies](https://link.juejin.cn/?target=https%3A%2F%2Fdocs.npmjs.com%2Fcli%2Fv7%2Fconfiguring-npm%2Fpackage-json%23dependencies)

## 不要太相信npm包的版本号！

如题，这个是血的教训换来的经验。

笔者在使用`system.js`时，使用的版本限制是：`system.js: "^6.3.2"`。
在安装依赖的时候，意外安装了`> 6.3.2`的版本，导致项目运行出错。
原因就是`system.js`作者，没有按照`semver`规范，进行版本号命名，导致笔者的项目，引入了**不可向下兼容**的更新，进而使项目运行出错。

## dependencies 生产环境依赖

生产环境中使用到的依赖，统一安装在`dependencies`下。

> 举个例子：

```json
"dependencies": {
	"chalk": "^2.4.2",
	"commander": "^3.0.0",
	"fs-extra": "^8.1.0",
	"inquirer": "^6.5.0",
	"mem-fs": "^1.1.3",
	"mem-fs-editor": "^6.0.0",
	"shelljs": "^0.8.3"
}

```

上述代码，是笔者做的`cli`工具包的`package.json`中的片段。
 `shelljs`用于操作文件，如果改在`devDependencies`声明，则用户安装当前工具包后，运行会报错。
 因为`devDependencies`字段声明的依赖，在`npm install 工具包`时，是不会安装的。必须在`dependencies`字段中声明，才会被安装。

## devDependencies 生产环境非依赖

生产环境不需要使用的依赖，都需要安装在`devDependencies`下。
 因为生产环境下，是不会安装`devDependencies`字段下的依赖的。

> 举个例子：

```perl
"devDependencies": {
	"@commitlint/cli": "^8.1.0",
	"@commitlint/config-conventional": "^8.1.0",
	"commitizen": "^4.0.3",
	"commitlint-config-cz": "^0.12.1",
	"cz-customizable": "^6.2.0",
	"standard-version": "^7.0.0"
}

```

上述代码，是笔者做的`cli`工具包的`package.json`中的片段。
 `commitizen`是笔者用于规范`Git`提交规范的依赖包，只在开发环境中使用，所以在`devDependencies`中声明。

## peerDependencies 运行环境依赖

当开发一些插件和工具包时，对使用方的运行环境的依赖包版本有要求，可以使用`peerDependencies`字段进行声明。

> 举个例子：

```json
{
  "name": "tea-latte",
  "version": "1.3.5",
  "peerDependencies": {
    "tea": "2.x"
  }
}

```

当前工具`tea-latte`，依赖`tea`包。而且，要求`tea`包是主版本2。
 当不满足要求时，控制台会进行报错处理。

> 注意
>  npm v7版本, peerDependencies会默认安装。
>  npm  v3 到 npm v6版本, `peerDependencies`不会自动安装。

## 参考文献

[package.json怎么管理依赖包版本？](https://juejin.cn/post/7108688424818704398)

[package.json 版本规则](https://juejin.cn/post/7038515143663157255)
