---
title: Vue3页面首次进入加载页
date: 2022-03-17
cover: https://jinyanlong-1305883696.cos.ap-hongkong.myqcloud.com/wallhaven-m9md18.jpg
tags:
 - Vue3
categories: Vue3
---

::: tip 介绍
Vue3 页面首次进入加载页 友好的实现加载等待<br>
:::

<!-- more -->

## 加载页的实现思路

* Vue文件的加载顺序是 `index.html` -> 请求页面资源 -> `App.vue` ->页面的其他内容
* 我们可以在`index.html` 写一个加载效果 然后当页面请求完毕资源后 在 `App.vue` 中做处理 隐藏在`index.html`的加载效果

![image-20220317171636997](https://jinyanlong-1305883696.cos.ap-hongkong.myqcloud.com/image-20220317171636997.png)

> 加载页样式浏览

* 快速浏览效果 [地址!](https://codepen.io/1079265662/pen/dyJGyJr)

![zpbq9-0k4my](https://jinyanlong-1305883696.cos.ap-hongkong.myqcloud.com/zpbq9-0k4my.gif)

## 实现代码

* 第一步 先要在`index.html` 写一个加载效果
  * <font color =#ff3040>注意: `<style>` 标签要写在`<head>`里面 这样页面css样式会提前加载 防止出现样式延迟</font>

```html
<!-- 样式 -->
<head>
  <style>
    :root {
      --main-clr: rgb(0, 127, 255);
      --font-clr: rgba(255, 255, 255, 1);
    }

    #loading-mask {
      position: fixed;
      left: 0;
      top: 0;
      user-select: none;
      z-index: 2147483647;
      overflow: hidden;
      background: #2098d1;
      transition: 0.55s ease-in-out 0.16s;
      height: 100%;
      width: 100%;
      cursor: wait;
    }

    .container {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100%;
    }

    .txt {
      position: relative;
      top: 3rem;
      font-family: sans-serif;
      color: var(--font-clr);
    }

    .support {
      width: 2rem;
      height: 2rem;
      position: absolute;
      animation: rotation 3.8s linear infinite;
    }

    .support:nth-child(1) {
      animation-delay: 0.15s;
    }

    .support:nth-child(2) {
      animation-delay: 0.3s;
    }

    .support:nth-child(3) {
      animation-delay: 0.45s;
    }

    .support:nth-child(4) {
      animation-delay: 0.6s;
    }

    .support:nth-child(5) {
      animation-delay: 0.75s;
    }

    .support:nth-child(6) {
      animation-delay: 0.9s;
    }

    @keyframes rotation {
      0% {
        opacity: 0.8;
      }

      30% {
        transform: rotate(180deg);
        opacity: 1;
      }

      40% {
        transform: rotate(360deg);
        opacity: 1;
      }

      80% {
        transform: rotate(720deg);
        opacity: 0.8;
      }

      81% {
        opacity: 0;
      }

      100% {
        transform: rotate(0deg);
        opacity: 0;
      }
    }

    .dot {
      width: 6px;
      height: 6px;
      border-radius: 50%;
      background: var(--font-clr);
      position: relative;
      top: 37px;
      left: 7px;
    }
  </style>
</head>

<!-- 设置加载页 -->
<body>
  <div id="loading-mask">
    <div class="container">
      <div class="support">
        <div class="dot"></div>
      </div>
      <div class="support">
        <div class="dot"></div>
      </div>
      <div class="support">
        <div class="dot"></div>
      </div>
      <div class="support">
        <div class="dot"></div>
      </div>
      <div class="support">
        <div class="dot"></div>
      </div>
      <div class="support">
        <div class="dot"></div>
      </div>
      <p class="txt">Please wait</p>
    </div>
  </div>
  <!-- 内容页 -->
  <div id="app" style="opacity: 0;transition: 0.25s ease-in-out 0.16s;">
  </div>
  <!-- built files will be auto injected -->
</body>
```

* 第二步 在`App.vue` 中取消页面的加载页
  * 当资源加载完毕后 自然会进入到`App.vue` 这时候我们隐藏吊加载页
  * <font color =#ff3040>注意: `display: none` 用不了过度效果 我们可以用 `opacity: 0` + `pointer-events: none` 来实现障眼法隐藏 这样他既可以过度隐藏 也不会妨碍我们进行交互</font>
  * 我们用原生js 操控css的时候 需要处理`-`把其转换为驼峰即可 例如: `pointer-events: none` 转化为 `pointerEvents = 'none'`

```vue
<script>
// 导入Vue3生命周期
import { onMounted } from 'vue'
export default {
  setup () {
    onMounted(() => {
    // 延时处理
      setTimeout(() => {
        // 显示页面内容
        document.getElementById('app').style.opacity = 1
        // 隐藏加载页的内容
        // document.getElementById('loading-mask').style.transform = 'translateY(-100vh)'
        // document.getElementById('loading-mask').style.height = '0px'
        // 障眼法 实现过度隐藏
        document.getElementById('loading-mask').style.opacity = '0'
        document.getElementById('loading-mask').style.pointerEvents = 'none'
      }, 300)
    })
  }
}
</script>
```
