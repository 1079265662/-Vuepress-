---
title: Vue3使用Pinia全局状态管理
date: 2021-08-31
cover: https://jinyanlong-1305883696.cos.ap-hongkong.myqcloud.com/202208311831885.jpg
tags:
 - Vue3
 - Pinia
categories: Vue3
---

::: tip 介绍
Vue3使用Pinia全局状态管理<br>
:::

<!-- more -->

## 什么是Pinia

Pinia是Vue生态里Vuex的代替者，一个全新Vue的状态管理库。在Vue3成为正式版以后，尤雨溪强势推荐的项目就是Pinia。那先来看看Pinia比Vuex好的地方，也就是Pinia的五大优势。

* 可以对Vue2和Vue3做到很好的支持，也就是老项目也可以使用Pinia。
* 抛弃了Mutations的操作，只有state、getters和actions.极大的简化了状态管理库的使用，让代码编写更加容易直观。
* 不需要嵌套模块，符合Vue3的Composition api ，让代码更加扁平化。
* 完整的TypeScript支持。Vue3版本的一大优势就是对TypeScript的支持，所以Pinia也做到了完整的支持。如果你对Vuex很熟悉的化，一定知道Vuex对TS的语法支持不是完整的（经常被吐槽）。
* 代码更加简洁，可以实现很好的代码自动分割。Vue2的时代，写代码需要来回翻滚屏幕屏幕找变量，非常的麻烦，Vue3的`Composition api`完美了解决这个问题。 可以实现代码自动分割，pinia也同样继承了这个优点。

## 创建Pinia 仓库

* 通过[create-vue](https://github.com/vuejs/create-vue) 创建一个Vue3项目 并勾选Pinia 就可以直接使用

![image-20220830113303942](https://jinyanlong-1305883696.cos.ap-hongkong.myqcloud.com/202208301133086.png)

## 创建一个state

* 和Vuex类似 Pinia拥有:
  * `id` 仓库的名称 作为唯一标识
  * `state` 声明状态储存数据 (相当于data储存数据)
  * `getters`  计算状态变化 (相当于watch监听数据变化)
  * `actions `进行一些方法逻辑处理 (相当于methods方法)
* 与Vuex比 Pinia取消了繁琐的 同步异步逻辑处理 所以的逻辑性方法只需要`actions ` 统一处理即可

> 创建一个Pinia仓库并使用

* 和Vuex一样 在`src`下 创建一个`stores`文件 作为仓库文件夹

![image-20220831182600363](https://jinyanlong-1305883696.cos.ap-hongkong.myqcloud.com/202208311826404.png)

* 创建文件后 需要引入Pinia仓库的方法 进行创建

```js
// 1. 定义状态容器和数据
// 2. 定义容器中的state (全局数据状态/储存)
// 3. 仓库中的action的使用

// 引入pinia仓库(容器)
import { defineStore } from 'pinia'

export const useCounterStore = defineStore({
  // 给仓库起一个名称(唯一标识)
  id: 'counter',
  // 声明状态储存数据 (相当于data储存数据)
  state: () => ({
    counter: 666
  }),
  // 计算状态变化 (相当于watch监听数据变化)
  getters: {},
  //  进行一些方法逻辑处理 (相当于methods方法)
  actions: {}
})

```

* 在Vue文件中 进行导入Pinia仓库 就可以使用啦

```vue
<template>
  <main>{{ store.counter }}</main>
</template>
<script lang="ts" setup>
// 导入pinia
import { useCounterStore } from '@/stores/counter'
// 实例化pinia
const store = useCounterStore()
console.log(store)
</script>
```



## 参考文献

[Pinia入门视频教程 全新一代状态管理工具Pinia -Vue3全家桶系列](https://jspang.com/article/82#toc33)
